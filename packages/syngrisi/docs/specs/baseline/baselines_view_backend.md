## План бэкенда

1) **Ручка `/v1/baselines`**
- Добавить обработку query-параметра `includeUsage` (string bool) в контроллере. После `paginate` собирать `snapshootId` текущей страницы, агрегировать `Check` по полю `baselineId` и добавлять `usageCount` в каждый элемент результата.
- Выделить helper `buildUsageCountMap` (принимает список id и агрегированные строки) для unit-тестов и читаемости.
- Обновить `RequestPaginationSchema`/OpenAPI, чтобы новое поле было документировано (опционально).

2) **Фильтр для чек-вью**
- В `testService.queryTests` реализовать поддержку фильтра `baselineSnapshotId`: получать список `test` id по чек-коллекции (`Check.find({ baselineId: snapId }).distinct('test')`), подставлять в основной фильтр `_id: { $in: [...] }`, возвращать пустую выдачу при отсутствии совпадений. Лишние поля убирать из фильтра перед вызовом `paginate`.
- Покрыть вспомогательную логику тестом без реальной БД (мокаем `Check`).

3) **Задача очистки осиротевших бейзлайнов**
- Создать core-функцию `handleOrphanBaselinesTask({ dryRun }, output, deps)` с зависимостями, пробрасываемыми для тестов. Критерий осиротевших: бейзлайны, чьи `snapshootId` не встречаются в `Check.baselineId`.
- HTTP-ручка `/v1/tasks/task_handle_orphan_baselines` + сервисный метод в `tasks.service` + запись в `tasksList`/навигацию админки.
- Выводить статистику: всего бейзлайнов, найдено осиротевших, первые N id/имен, суммарно удалено (в execute режиме). Dry run по умолчанию.

4) **Тесты**
- Unit на `buildUsageCountMap` (корректное сопоставление id, отсутствие id → 0).
- Unit на вспомогательную функцию фильтрации тестов по baselineSnapshotId (подстановка пустого массива, массив с id).
- Unit на `handleOrphanBaselinesTask` с моками моделей (dry run не удаляет, execute удаляет из мока, выводит сообщения в `MockOutputWriter`).

5) **Безопасность и обратная совместимость**
- Не менять поведение `/v1/baselines` без `includeUsage`.
- Существующие клиенты задач не ломаются: новая задача в отдельной ручке; существующие схемы не затрагиваются.
