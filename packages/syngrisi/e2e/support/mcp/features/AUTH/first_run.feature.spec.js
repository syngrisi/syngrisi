// Generated from: ../../features/AUTH/first_run.feature
import { test } from "../../../fixtures/index.ts";

test.describe('First run', () => {

  test.beforeEach('Background', async ({ When, appServer }, testInfo) => { if (testInfo.error) return;
    await When('I set env variables:', {"docString":{"content":"      SYNGRISI_DISABLE_FIRST_RUN: false\n      SYNGRISI_AUTH: true"}}, { appServer }); 
  });
  
  test('Change Administrator password and login to system', { tag: ['@fast-server', '@smoke'] }, async ({ When, Then, appServer, page, testData }) => { 
    await When('I open the app', null, { appServer, page, testData }); 
    await Then('the element with locator "#title" should have contains text "Change Password for default Administrator"', null, { page, testData }); 
    await When('I set "Password-123" to the inputfield "#new-password"', null, { page, testData }); 
    await When('I set "Password-123" to the inputfield "#new-password-confirmation"', null, { page, testData }); 
    await When('I click element with locator "#change-password"', null, { page, testData }); 
    await Then('the current url contains "auth/changeSuccess"', null, { page, testData }); 
    await Then('the element with locator "h1=Success!" should be visible', null, { page }); 
    await When('I go to "first_run" page', null, { appServer, page }); 
    await When('I set "Password-123" to the inputfield "#new-password"', null, { page, testData }); 
    await When('I set "Password-123" to the inputfield "#new-password-confirmation"', null, { page, testData }); 
    await When('I click element with locator "#change-password"', null, { page, testData }); 
    await Then('the current url does not contain "auth/changeSuccess"', null, { page, testData }); 
    await Then('the element with locator "#error-message" should have contains text "forbidden"', null, { page, testData }); 
  });

});

// == technical section ==

test.use({
  $test: [({}, use) => use(test), { scope: 'test', box: true }],
  $uri: [({}, use) => use('../../features/AUTH/first_run.feature'), { scope: 'test', box: true }],
  $bddFileData: [({}, use) => use(bddFileData), { scope: "test", box: true }],
});

const bddFileData = [ // bdd-data-start
  {"pwTestLine":10,"pickleLine":14,"tags":["@fast-server","@smoke"],"steps":[{"pwStepLine":7,"gherkinStepLine":6,"keywordType":"Action","textWithKeyword":"When I set env variables:","isBg":true,"stepMatchArguments":[]},{"pwStepLine":11,"gherkinStepLine":15,"keywordType":"Action","textWithKeyword":"When I open the app","stepMatchArguments":[]},{"pwStepLine":12,"gherkinStepLine":16,"keywordType":"Outcome","textWithKeyword":"Then the element with locator \"#title\" should have contains text \"Change Password for default Administrator\"","stepMatchArguments":[{"group":{"start":17,"value":"locator","children":[]},"parameterTypeName":"target"},{"group":{"start":25,"value":"\"#title\"","children":[{"start":26,"value":"#title","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"},{"group":{"start":60,"value":"\"Change Password for default Administrator\"","children":[{"start":61,"value":"Change Password for default Administrator","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":13,"gherkinStepLine":17,"keywordType":"Action","textWithKeyword":"When I set \"Password-123\" to the inputfield \"#new-password\"","stepMatchArguments":[{"group":{"start":6,"value":"\"Password-123\"","children":[{"start":7,"value":"Password-123","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"},{"group":{"start":39,"value":"\"#new-password\"","children":[{"start":40,"value":"#new-password","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":14,"gherkinStepLine":18,"keywordType":"Action","textWithKeyword":"When I set \"Password-123\" to the inputfield \"#new-password-confirmation\"","stepMatchArguments":[{"group":{"start":6,"value":"\"Password-123\"","children":[{"start":7,"value":"Password-123","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"},{"group":{"start":39,"value":"\"#new-password-confirmation\"","children":[{"start":40,"value":"#new-password-confirmation","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":15,"gherkinStepLine":19,"keywordType":"Action","textWithKeyword":"When I click element with locator \"#change-password\"","stepMatchArguments":[{"group":{"start":21,"value":"locator","children":[]},"parameterTypeName":"target"},{"group":{"start":29,"value":"\"#change-password\"","children":[{"start":30,"value":"#change-password","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":16,"gherkinStepLine":20,"keywordType":"Outcome","textWithKeyword":"Then the current url contains \"auth/changeSuccess\"","stepMatchArguments":[{"group":{"start":25,"value":"\"auth/changeSuccess\"","children":[{"start":26,"value":"auth/changeSuccess","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":17,"gherkinStepLine":21,"keywordType":"Outcome","textWithKeyword":"Then the element with locator \"h1=Success!\" should be visible","stepMatchArguments":[{"group":{"start":17,"value":"locator","children":[]},"parameterTypeName":"target"},{"group":{"start":25,"value":"\"h1=Success!\"","children":[{"start":26,"value":"h1=Success!","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"},{"group":{"start":49,"value":"visible","children":[]},"parameterTypeName":"condition"}]},{"pwStepLine":18,"gherkinStepLine":24,"keywordType":"Action","textWithKeyword":"When I go to \"first_run\" page","stepMatchArguments":[{"group":{"start":8,"value":"\"first_run\"","children":[{"start":9,"value":"first_run","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":19,"gherkinStepLine":25,"keywordType":"Action","textWithKeyword":"When I set \"Password-123\" to the inputfield \"#new-password\"","stepMatchArguments":[{"group":{"start":6,"value":"\"Password-123\"","children":[{"start":7,"value":"Password-123","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"},{"group":{"start":39,"value":"\"#new-password\"","children":[{"start":40,"value":"#new-password","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":20,"gherkinStepLine":26,"keywordType":"Action","textWithKeyword":"When I set \"Password-123\" to the inputfield \"#new-password-confirmation\"","stepMatchArguments":[{"group":{"start":6,"value":"\"Password-123\"","children":[{"start":7,"value":"Password-123","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"},{"group":{"start":39,"value":"\"#new-password-confirmation\"","children":[{"start":40,"value":"#new-password-confirmation","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":21,"gherkinStepLine":27,"keywordType":"Action","textWithKeyword":"When I click element with locator \"#change-password\"","stepMatchArguments":[{"group":{"start":21,"value":"locator","children":[]},"parameterTypeName":"target"},{"group":{"start":29,"value":"\"#change-password\"","children":[{"start":30,"value":"#change-password","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":22,"gherkinStepLine":28,"keywordType":"Outcome","textWithKeyword":"Then the current url does not contain \"auth/changeSuccess\"","stepMatchArguments":[{"group":{"start":33,"value":"\"auth/changeSuccess\"","children":[{"start":34,"value":"auth/changeSuccess","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":23,"gherkinStepLine":29,"keywordType":"Outcome","textWithKeyword":"Then the element with locator \"#error-message\" should have contains text \"forbidden\"","stepMatchArguments":[{"group":{"start":17,"value":"locator","children":[]},"parameterTypeName":"target"},{"group":{"start":25,"value":"\"#error-message\"","children":[{"start":26,"value":"#error-message","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"},{"group":{"start":68,"value":"\"forbidden\"","children":[{"start":69,"value":"forbidden","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]}]},
]; // bdd-data-end