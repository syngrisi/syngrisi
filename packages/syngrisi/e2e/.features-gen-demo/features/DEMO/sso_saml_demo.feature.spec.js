// Generated from: features/DEMO/sso_saml_demo.feature
import { test } from "../../../support/fixtures/index.ts";

test.describe('SSO SAML 2.0 Authentication Demo', () => {

  test.beforeEach('Background', async ({ Given, When, appServer, ssoServer, testData }, testInfo) => { if (testInfo.error) return;
    await When('I configure SAML SSO with auto-provisioned settings', null, { ssoServer }); 
    await When('I set env variables:', {"docString":{"content":"SYNGRISI_AUTH: true\nSYNGRISI_TEST_MODE: false"}}, { appServer }); 
    await Given('I start Server', null, { appServer, testData }); 
  });
  
  test('Demo: SAML 2.0 SSO Login with Logto IdP', { tag: ['@demo', '@sso-external', '@slow', '@saml', '@sso'] }, async ({ When, Then, And, appServer, page, testData }) => { 
    await When('I reload session', null, { page, testData }); 
    await When('I open the app', null, { appServer, page, testData }); 
    await When('I announce: "Welcome to the SAML 2.0 SSO demonstration. We will show how enterprise-grade SAML authentication works with Syngrisi."', null, { page }); 
    await Then('the title is "Login Page"', null, { page }); 
    await When('I announce: "SAML 2.0 is a widely adopted standard for enterprise single sign-on. It is commonly used with Microsoft Active Directory, Okta, and other identity management systems."', null, { page }); 
    await When('I highlight element "a[href*=\'/v1/auth/sso\']"', null, { page }); 
    await When('I announce: "Notice the Single Sign-On button. With SAML, Syngrisi acts as a Service Provider, delegating authentication to your Identity Provider."', null, { page }); 
    await Then('the SSO login button should be visible', null, { page }); 
    await When('I announce: "When you click this button, Syngrisi generates a SAML authentication request and redirects you to the Identity Provider."', null, { page }); 
    await And('I clear highlight', null, { page }); 
    await When('I click SSO login button', null, { page }); 
    await When('I announce: "Now we are on the Logto Identity Provider. In a real enterprise scenario, this would be your organization\'s SAML IdP, such as Active Directory Federation Services or Okta."', null, { page }); 
    await When('I highlight element "input[name=\'identifier\']"', null, { page }); 
    await When('I announce: "Users authenticate using their organizational credentials. The Identity Provider validates these credentials securely."', null, { page }); 
    await When('I login to Logto with username "testuser" and password "Test123!"', null, { page }); 
    await When('I announce: "After successful authentication, the Identity Provider creates a digitally signed SAML assertion containing user information and sends it back to Syngrisi."', null, { page }); 
    await Then('I should be redirected back to the app', null, { appServer, page }); 
    await When('I announce: "Excellent! Syngrisi has validated the SAML assertion and established your authenticated session."', null, { page }); 
    await Then('I should be authenticated via SSO', null, { page }); 
    await When('I highlight element "h1"', null, { page }); 
    await When('I announce: "You are now securely authenticated. All user information came from the SAML assertion - no passwords were transmitted to or stored in Syngrisi."', null, { page }); 
    await When('I clear highlight', null, { page }); 
    await When('I announce: "This SAML 2.0 flow provides enterprise-grade security and centralized identity management. Fantastic!"', null, { page }); 
    await And('I end the demo', null, { page }); 
  });

  test('Demo: SAML Configuration and Trust', { tag: ['@demo', '@sso-external', '@slow', '@saml', '@sso'] }, async ({ When, Then, And, appServer, page, testData }) => { 
    await When('I reload session', null, { page, testData }); 
    await When('I open the app', null, { appServer, page, testData }); 
    await When('I announce: "Let me explain how SAML 2.0 trust relationships are established between Syngrisi and your Identity Provider."', null, { page }); 
    await Then('the title is "Login Page"', null, { page }); 
    await When('I highlight element "a[href*=\'/v1/auth/sso\']"', null, { page }); 
    await When('I announce: "SAML configuration requires several key components. First, the Identity Provider Entry Point - this is the URL where authentication requests are sent."', null, { page }); 
    await When('I announce: "Second, the Service Provider Entity ID - this uniquely identifies Syngrisi to your Identity Provider."', null, { page }); 
    await When('I announce: "Third, and most importantly, the IdP Signing Certificate. This certificate is used to verify that SAML assertions genuinely come from your trusted Identity Provider."', null, { page }); 
    await When('I announce: "The certificate creates a cryptographic trust relationship, ensuring that only your authorized Identity Provider can authenticate users to Syngrisi."', null, { page }); 
    await When('I announce: "Additionally, you need to configure the Assertion Consumer Service URL in your Identity Provider. This tells the IdP where to send SAML assertions after successful authentication."', null, { page }); 
    await When('I clear highlight', null, { page }); 
    await When('I announce: "With these components properly configured, you have a secure, enterprise-ready SAML integration."', null, { page }); 
    await And('I end the demo', null, { page }); 
  });

  test('Demo: SAML Account Linking', { tag: ['@demo', '@sso-external', '@slow', '@saml', '@sso'] }, async ({ When, Then, And, appServer, page, testData }) => { 
    await When('I reset user "test@syngrisi.test" provider to local', null, { appServer }); 
    await When('I reload session', null, { page, testData }); 
    await When('I open the app', null, { appServer, page, testData }); 
    await When('I announce: "This demonstration shows SAML account linking. When an existing Syngrisi user logs in via SAML, their account is automatically linked to the SAML provider."', null, { page }); 
    await Then('the title is "Login Page"', null, { page }); 
    await When('I highlight element "a[href*=\'/v1/auth/sso\']"', null, { page }); 
    await When('I announce: "Account linking works by matching the email address in the SAML assertion with existing user accounts in Syngrisi."', null, { page }); 
    await When('I clear highlight', null, { page }); 
    await When('I click SSO login button', null, { page }); 
    await When('I announce: "During authentication, the Identity Provider includes user attributes in the SAML assertion, such as email, display name, and groups."', null, { page }); 
    await When('I login to Logto with username "testuser" and password "Test123!"', null, { page }); 
    await Then('I should be redirected back to the app', null, { appServer, page }); 
    await Then('I should be authenticated via SSO', null, { page }); 
    await Then('the user "test@syngrisi.test" should have provider type "saml"', null, { appServer }); 
    await When('I announce: "Perfect! The existing local account has been successfully linked to the SAML provider. This user will now authenticate via SAML for all future logins."', null, { page }); 
    await And('I end the demo', null, { page }); 
  });

  test('Demo: SAML User Provisioning', { tag: ['@demo', '@sso-external', '@slow', '@saml', '@sso'] }, async ({ When, Then, And, appServer, page, testData }) => { 
    await When('I reload session', null, { page, testData }); 
    await When('I open the app', null, { appServer, page, testData }); 
    await When('I announce: "This demonstration shows SAML user provisioning. When a new user authenticates via SAML for the first time, Syngrisi automatically creates their account."', null, { page }); 
    await Then('the title is "Login Page"', null, { page }); 
    await When('I highlight element "a[href*=\'/v1/auth/sso\']"', null, { page }); 
    await When('I announce: "This is called Just-in-Time provisioning. User information from the SAML assertion is used to create the Syngrisi account automatically."', null, { page }); 
    await When('I clear highlight', null, { page }); 
    await When('I click SSO login button', null, { page }); 
    await When('I announce: "The SAML assertion contains user attributes such as email, name, and potentially group memberships. Syngrisi uses these to populate the new user account."', null, { page }); 
    await When('I login to Logto with username "testuser" and password "Test123!"', null, { page }); 
    await Then('I should be redirected back to the app', null, { appServer, page }); 
    await Then('I should be authenticated via SSO', null, { page }); 
    await Then('a new user "test@syngrisi.test" should be created with role "reviewer"', null, { appServer }); 
    await When('I announce: "Excellent! A new user account was automatically created with the reviewer role. This streamlines onboarding - no manual account creation required."', null, { page }); 
    await And('I end the demo', null, { page }); 
  });

});

// == technical section ==

test.use({
  $test: [({}, use) => use(test), { scope: 'test', box: true }],
  $uri: [({}, use) => use('features/DEMO/sso_saml_demo.feature'), { scope: 'test', box: true }],
  $bddFileData: [({}, use) => use(bddFileData), { scope: "test", box: true }],
});

const bddFileData = [ // bdd-data-start
  {"pwTestLine":12,"pickleLine":25,"slow":true,"tags":["@demo","@sso-external","@slow","@saml","@sso"],"steps":[{"pwStepLine":7,"gherkinStepLine":17,"keywordType":"Action","textWithKeyword":"When I configure SAML SSO with auto-provisioned settings","isBg":true,"stepMatchArguments":[]},{"pwStepLine":8,"gherkinStepLine":18,"keywordType":"Action","textWithKeyword":"When I set env variables:","isBg":true,"stepMatchArguments":[]},{"pwStepLine":9,"gherkinStepLine":23,"keywordType":"Context","textWithKeyword":"Given I start Server","isBg":true,"stepMatchArguments":[]},{"pwStepLine":13,"gherkinStepLine":27,"keywordType":"Action","textWithKeyword":"When I reload session","stepMatchArguments":[]},{"pwStepLine":14,"gherkinStepLine":28,"keywordType":"Action","textWithKeyword":"When I open the app","stepMatchArguments":[]},{"pwStepLine":15,"gherkinStepLine":31,"keywordType":"Action","textWithKeyword":"When I announce: \"Welcome to the SAML 2.0 SSO demonstration. We will show how enterprise-grade SAML authentication works with Syngrisi.\"","stepMatchArguments":[{"group":{"start":12,"value":"\"Welcome to the SAML 2.0 SSO demonstration. We will show how enterprise-grade SAML authentication works with Syngrisi.\"","children":[{"start":13,"value":"Welcome to the SAML 2.0 SSO demonstration. We will show how enterprise-grade SAML authentication works with Syngrisi.","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":16,"gherkinStepLine":32,"keywordType":"Outcome","textWithKeyword":"Then the title is \"Login Page\"","stepMatchArguments":[{"group":{"start":13,"value":"\"Login Page\"","children":[{"start":14,"value":"Login Page","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":17,"gherkinStepLine":35,"keywordType":"Action","textWithKeyword":"When I announce: \"SAML 2.0 is a widely adopted standard for enterprise single sign-on. It is commonly used with Microsoft Active Directory, Okta, and other identity management systems.\"","stepMatchArguments":[{"group":{"start":12,"value":"\"SAML 2.0 is a widely adopted standard for enterprise single sign-on. It is commonly used with Microsoft Active Directory, Okta, and other identity management systems.\"","children":[{"start":13,"value":"SAML 2.0 is a widely adopted standard for enterprise single sign-on. It is commonly used with Microsoft Active Directory, Okta, and other identity management systems.","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":18,"gherkinStepLine":38,"keywordType":"Action","textWithKeyword":"When I highlight element \"a[href*='/v1/auth/sso']\"","stepMatchArguments":[{"group":{"start":20,"value":"\"a[href*='/v1/auth/sso']\"","children":[{"start":21,"value":"a[href*='/v1/auth/sso']","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":19,"gherkinStepLine":39,"keywordType":"Action","textWithKeyword":"When I announce: \"Notice the Single Sign-On button. With SAML, Syngrisi acts as a Service Provider, delegating authentication to your Identity Provider.\"","stepMatchArguments":[{"group":{"start":12,"value":"\"Notice the Single Sign-On button. With SAML, Syngrisi acts as a Service Provider, delegating authentication to your Identity Provider.\"","children":[{"start":13,"value":"Notice the Single Sign-On button. With SAML, Syngrisi acts as a Service Provider, delegating authentication to your Identity Provider.","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":20,"gherkinStepLine":40,"keywordType":"Outcome","textWithKeyword":"Then the SSO login button should be visible","stepMatchArguments":[]},{"pwStepLine":21,"gherkinStepLine":43,"keywordType":"Action","textWithKeyword":"When I announce: \"When you click this button, Syngrisi generates a SAML authentication request and redirects you to the Identity Provider.\"","stepMatchArguments":[{"group":{"start":12,"value":"\"When you click this button, Syngrisi generates a SAML authentication request and redirects you to the Identity Provider.\"","children":[{"start":13,"value":"When you click this button, Syngrisi generates a SAML authentication request and redirects you to the Identity Provider.","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":22,"gherkinStepLine":44,"keywordType":"Action","textWithKeyword":"And I clear highlight","stepMatchArguments":[]},{"pwStepLine":23,"gherkinStepLine":47,"keywordType":"Action","textWithKeyword":"When I click SSO login button","stepMatchArguments":[]},{"pwStepLine":24,"gherkinStepLine":50,"keywordType":"Action","textWithKeyword":"When I announce: \"Now we are on the Logto Identity Provider. In a real enterprise scenario, this would be your organization's SAML IdP, such as Active Directory Federation Services or Okta.\"","stepMatchArguments":[{"group":{"start":12,"value":"\"Now we are on the Logto Identity Provider. In a real enterprise scenario, this would be your organization's SAML IdP, such as Active Directory Federation Services or Okta.\"","children":[{"start":13,"value":"Now we are on the Logto Identity Provider. In a real enterprise scenario, this would be your organization's SAML IdP, such as Active Directory Federation Services or Okta.","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":25,"gherkinStepLine":53,"keywordType":"Action","textWithKeyword":"When I highlight element \"input[name='identifier']\"","stepMatchArguments":[{"group":{"start":20,"value":"\"input[name='identifier']\"","children":[{"start":21,"value":"input[name='identifier']","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":26,"gherkinStepLine":54,"keywordType":"Action","textWithKeyword":"When I announce: \"Users authenticate using their organizational credentials. The Identity Provider validates these credentials securely.\"","stepMatchArguments":[{"group":{"start":12,"value":"\"Users authenticate using their organizational credentials. The Identity Provider validates these credentials securely.\"","children":[{"start":13,"value":"Users authenticate using their organizational credentials. The Identity Provider validates these credentials securely.","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":27,"gherkinStepLine":57,"keywordType":"Action","textWithKeyword":"When I login to Logto with username \"testuser\" and password \"Test123!\"","stepMatchArguments":[{"group":{"start":31,"value":"\"testuser\"","children":[{"start":32,"value":"testuser","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"},{"group":{"start":55,"value":"\"Test123!\"","children":[{"start":56,"value":"Test123!","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":28,"gherkinStepLine":60,"keywordType":"Action","textWithKeyword":"When I announce: \"After successful authentication, the Identity Provider creates a digitally signed SAML assertion containing user information and sends it back to Syngrisi.\"","stepMatchArguments":[{"group":{"start":12,"value":"\"After successful authentication, the Identity Provider creates a digitally signed SAML assertion containing user information and sends it back to Syngrisi.\"","children":[{"start":13,"value":"After successful authentication, the Identity Provider creates a digitally signed SAML assertion containing user information and sends it back to Syngrisi.","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":29,"gherkinStepLine":63,"keywordType":"Outcome","textWithKeyword":"Then I should be redirected back to the app","stepMatchArguments":[]},{"pwStepLine":30,"gherkinStepLine":66,"keywordType":"Action","textWithKeyword":"When I announce: \"Excellent! Syngrisi has validated the SAML assertion and established your authenticated session.\"","stepMatchArguments":[{"group":{"start":12,"value":"\"Excellent! Syngrisi has validated the SAML assertion and established your authenticated session.\"","children":[{"start":13,"value":"Excellent! Syngrisi has validated the SAML assertion and established your authenticated session.","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":31,"gherkinStepLine":67,"keywordType":"Outcome","textWithKeyword":"Then I should be authenticated via SSO","stepMatchArguments":[]},{"pwStepLine":32,"gherkinStepLine":70,"keywordType":"Action","textWithKeyword":"When I highlight element \"h1\"","stepMatchArguments":[{"group":{"start":20,"value":"\"h1\"","children":[{"start":21,"value":"h1","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":33,"gherkinStepLine":71,"keywordType":"Action","textWithKeyword":"When I announce: \"You are now securely authenticated. All user information came from the SAML assertion - no passwords were transmitted to or stored in Syngrisi.\"","stepMatchArguments":[{"group":{"start":12,"value":"\"You are now securely authenticated. All user information came from the SAML assertion - no passwords were transmitted to or stored in Syngrisi.\"","children":[{"start":13,"value":"You are now securely authenticated. All user information came from the SAML assertion - no passwords were transmitted to or stored in Syngrisi.","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":34,"gherkinStepLine":74,"keywordType":"Action","textWithKeyword":"When I clear highlight","stepMatchArguments":[]},{"pwStepLine":35,"gherkinStepLine":75,"keywordType":"Action","textWithKeyword":"When I announce: \"This SAML 2.0 flow provides enterprise-grade security and centralized identity management. Fantastic!\"","stepMatchArguments":[{"group":{"start":12,"value":"\"This SAML 2.0 flow provides enterprise-grade security and centralized identity management. Fantastic!\"","children":[{"start":13,"value":"This SAML 2.0 flow provides enterprise-grade security and centralized identity management. Fantastic!","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":36,"gherkinStepLine":76,"keywordType":"Action","textWithKeyword":"And I end the demo","stepMatchArguments":[]}]},
  {"pwTestLine":39,"pickleLine":78,"slow":true,"tags":["@demo","@sso-external","@slow","@saml","@sso"],"steps":[{"pwStepLine":7,"gherkinStepLine":17,"keywordType":"Action","textWithKeyword":"When I configure SAML SSO with auto-provisioned settings","isBg":true,"stepMatchArguments":[]},{"pwStepLine":8,"gherkinStepLine":18,"keywordType":"Action","textWithKeyword":"When I set env variables:","isBg":true,"stepMatchArguments":[]},{"pwStepLine":9,"gherkinStepLine":23,"keywordType":"Context","textWithKeyword":"Given I start Server","isBg":true,"stepMatchArguments":[]},{"pwStepLine":40,"gherkinStepLine":80,"keywordType":"Action","textWithKeyword":"When I reload session","stepMatchArguments":[]},{"pwStepLine":41,"gherkinStepLine":81,"keywordType":"Action","textWithKeyword":"When I open the app","stepMatchArguments":[]},{"pwStepLine":42,"gherkinStepLine":84,"keywordType":"Action","textWithKeyword":"When I announce: \"Let me explain how SAML 2.0 trust relationships are established between Syngrisi and your Identity Provider.\"","stepMatchArguments":[{"group":{"start":12,"value":"\"Let me explain how SAML 2.0 trust relationships are established between Syngrisi and your Identity Provider.\"","children":[{"start":13,"value":"Let me explain how SAML 2.0 trust relationships are established between Syngrisi and your Identity Provider.","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":43,"gherkinStepLine":85,"keywordType":"Outcome","textWithKeyword":"Then the title is \"Login Page\"","stepMatchArguments":[{"group":{"start":13,"value":"\"Login Page\"","children":[{"start":14,"value":"Login Page","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":44,"gherkinStepLine":88,"keywordType":"Action","textWithKeyword":"When I highlight element \"a[href*='/v1/auth/sso']\"","stepMatchArguments":[{"group":{"start":20,"value":"\"a[href*='/v1/auth/sso']\"","children":[{"start":21,"value":"a[href*='/v1/auth/sso']","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":45,"gherkinStepLine":89,"keywordType":"Action","textWithKeyword":"When I announce: \"SAML configuration requires several key components. First, the Identity Provider Entry Point - this is the URL where authentication requests are sent.\"","stepMatchArguments":[{"group":{"start":12,"value":"\"SAML configuration requires several key components. First, the Identity Provider Entry Point - this is the URL where authentication requests are sent.\"","children":[{"start":13,"value":"SAML configuration requires several key components. First, the Identity Provider Entry Point - this is the URL where authentication requests are sent.","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":46,"gherkinStepLine":91,"keywordType":"Action","textWithKeyword":"When I announce: \"Second, the Service Provider Entity ID - this uniquely identifies Syngrisi to your Identity Provider.\"","stepMatchArguments":[{"group":{"start":12,"value":"\"Second, the Service Provider Entity ID - this uniquely identifies Syngrisi to your Identity Provider.\"","children":[{"start":13,"value":"Second, the Service Provider Entity ID - this uniquely identifies Syngrisi to your Identity Provider.","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":47,"gherkinStepLine":93,"keywordType":"Action","textWithKeyword":"When I announce: \"Third, and most importantly, the IdP Signing Certificate. This certificate is used to verify that SAML assertions genuinely come from your trusted Identity Provider.\"","stepMatchArguments":[{"group":{"start":12,"value":"\"Third, and most importantly, the IdP Signing Certificate. This certificate is used to verify that SAML assertions genuinely come from your trusted Identity Provider.\"","children":[{"start":13,"value":"Third, and most importantly, the IdP Signing Certificate. This certificate is used to verify that SAML assertions genuinely come from your trusted Identity Provider.","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":48,"gherkinStepLine":95,"keywordType":"Action","textWithKeyword":"When I announce: \"The certificate creates a cryptographic trust relationship, ensuring that only your authorized Identity Provider can authenticate users to Syngrisi.\"","stepMatchArguments":[{"group":{"start":12,"value":"\"The certificate creates a cryptographic trust relationship, ensuring that only your authorized Identity Provider can authenticate users to Syngrisi.\"","children":[{"start":13,"value":"The certificate creates a cryptographic trust relationship, ensuring that only your authorized Identity Provider can authenticate users to Syngrisi.","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":49,"gherkinStepLine":97,"keywordType":"Action","textWithKeyword":"When I announce: \"Additionally, you need to configure the Assertion Consumer Service URL in your Identity Provider. This tells the IdP where to send SAML assertions after successful authentication.\"","stepMatchArguments":[{"group":{"start":12,"value":"\"Additionally, you need to configure the Assertion Consumer Service URL in your Identity Provider. This tells the IdP where to send SAML assertions after successful authentication.\"","children":[{"start":13,"value":"Additionally, you need to configure the Assertion Consumer Service URL in your Identity Provider. This tells the IdP where to send SAML assertions after successful authentication.","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":50,"gherkinStepLine":100,"keywordType":"Action","textWithKeyword":"When I clear highlight","stepMatchArguments":[]},{"pwStepLine":51,"gherkinStepLine":101,"keywordType":"Action","textWithKeyword":"When I announce: \"With these components properly configured, you have a secure, enterprise-ready SAML integration.\"","stepMatchArguments":[{"group":{"start":12,"value":"\"With these components properly configured, you have a secure, enterprise-ready SAML integration.\"","children":[{"start":13,"value":"With these components properly configured, you have a secure, enterprise-ready SAML integration.","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":52,"gherkinStepLine":102,"keywordType":"Action","textWithKeyword":"And I end the demo","stepMatchArguments":[]}]},
  {"pwTestLine":55,"pickleLine":104,"slow":true,"tags":["@demo","@sso-external","@slow","@saml","@sso"],"steps":[{"pwStepLine":7,"gherkinStepLine":17,"keywordType":"Action","textWithKeyword":"When I configure SAML SSO with auto-provisioned settings","isBg":true,"stepMatchArguments":[]},{"pwStepLine":8,"gherkinStepLine":18,"keywordType":"Action","textWithKeyword":"When I set env variables:","isBg":true,"stepMatchArguments":[]},{"pwStepLine":9,"gherkinStepLine":23,"keywordType":"Context","textWithKeyword":"Given I start Server","isBg":true,"stepMatchArguments":[]},{"pwStepLine":56,"gherkinStepLine":107,"keywordType":"Action","textWithKeyword":"When I reset user \"test@syngrisi.test\" provider to local","stepMatchArguments":[{"group":{"start":13,"value":"\"test@syngrisi.test\"","children":[{"start":14,"value":"test@syngrisi.test","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":57,"gherkinStepLine":109,"keywordType":"Action","textWithKeyword":"When I reload session","stepMatchArguments":[]},{"pwStepLine":58,"gherkinStepLine":110,"keywordType":"Action","textWithKeyword":"When I open the app","stepMatchArguments":[]},{"pwStepLine":59,"gherkinStepLine":113,"keywordType":"Action","textWithKeyword":"When I announce: \"This demonstration shows SAML account linking. When an existing Syngrisi user logs in via SAML, their account is automatically linked to the SAML provider.\"","stepMatchArguments":[{"group":{"start":12,"value":"\"This demonstration shows SAML account linking. When an existing Syngrisi user logs in via SAML, their account is automatically linked to the SAML provider.\"","children":[{"start":13,"value":"This demonstration shows SAML account linking. When an existing Syngrisi user logs in via SAML, their account is automatically linked to the SAML provider.","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":60,"gherkinStepLine":114,"keywordType":"Outcome","textWithKeyword":"Then the title is \"Login Page\"","stepMatchArguments":[{"group":{"start":13,"value":"\"Login Page\"","children":[{"start":14,"value":"Login Page","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":61,"gherkinStepLine":117,"keywordType":"Action","textWithKeyword":"When I highlight element \"a[href*='/v1/auth/sso']\"","stepMatchArguments":[{"group":{"start":20,"value":"\"a[href*='/v1/auth/sso']\"","children":[{"start":21,"value":"a[href*='/v1/auth/sso']","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":62,"gherkinStepLine":118,"keywordType":"Action","textWithKeyword":"When I announce: \"Account linking works by matching the email address in the SAML assertion with existing user accounts in Syngrisi.\"","stepMatchArguments":[{"group":{"start":12,"value":"\"Account linking works by matching the email address in the SAML assertion with existing user accounts in Syngrisi.\"","children":[{"start":13,"value":"Account linking works by matching the email address in the SAML assertion with existing user accounts in Syngrisi.","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":63,"gherkinStepLine":121,"keywordType":"Action","textWithKeyword":"When I clear highlight","stepMatchArguments":[]},{"pwStepLine":64,"gherkinStepLine":122,"keywordType":"Action","textWithKeyword":"When I click SSO login button","stepMatchArguments":[]},{"pwStepLine":65,"gherkinStepLine":125,"keywordType":"Action","textWithKeyword":"When I announce: \"During authentication, the Identity Provider includes user attributes in the SAML assertion, such as email, display name, and groups.\"","stepMatchArguments":[{"group":{"start":12,"value":"\"During authentication, the Identity Provider includes user attributes in the SAML assertion, such as email, display name, and groups.\"","children":[{"start":13,"value":"During authentication, the Identity Provider includes user attributes in the SAML assertion, such as email, display name, and groups.","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":66,"gherkinStepLine":128,"keywordType":"Action","textWithKeyword":"When I login to Logto with username \"testuser\" and password \"Test123!\"","stepMatchArguments":[{"group":{"start":31,"value":"\"testuser\"","children":[{"start":32,"value":"testuser","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"},{"group":{"start":55,"value":"\"Test123!\"","children":[{"start":56,"value":"Test123!","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":67,"gherkinStepLine":131,"keywordType":"Outcome","textWithKeyword":"Then I should be redirected back to the app","stepMatchArguments":[]},{"pwStepLine":68,"gherkinStepLine":132,"keywordType":"Outcome","textWithKeyword":"Then I should be authenticated via SSO","stepMatchArguments":[]},{"pwStepLine":69,"gherkinStepLine":135,"keywordType":"Outcome","textWithKeyword":"Then the user \"test@syngrisi.test\" should have provider type \"saml\"","stepMatchArguments":[{"group":{"start":9,"value":"\"test@syngrisi.test\"","children":[{"start":10,"value":"test@syngrisi.test","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"},{"group":{"start":56,"value":"\"saml\"","children":[{"start":57,"value":"saml","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":70,"gherkinStepLine":138,"keywordType":"Action","textWithKeyword":"When I announce: \"Perfect! The existing local account has been successfully linked to the SAML provider. This user will now authenticate via SAML for all future logins.\"","stepMatchArguments":[{"group":{"start":12,"value":"\"Perfect! The existing local account has been successfully linked to the SAML provider. This user will now authenticate via SAML for all future logins.\"","children":[{"start":13,"value":"Perfect! The existing local account has been successfully linked to the SAML provider. This user will now authenticate via SAML for all future logins.","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":71,"gherkinStepLine":139,"keywordType":"Action","textWithKeyword":"And I end the demo","stepMatchArguments":[]}]},
  {"pwTestLine":74,"pickleLine":141,"slow":true,"tags":["@demo","@sso-external","@slow","@saml","@sso"],"steps":[{"pwStepLine":7,"gherkinStepLine":17,"keywordType":"Action","textWithKeyword":"When I configure SAML SSO with auto-provisioned settings","isBg":true,"stepMatchArguments":[]},{"pwStepLine":8,"gherkinStepLine":18,"keywordType":"Action","textWithKeyword":"When I set env variables:","isBg":true,"stepMatchArguments":[]},{"pwStepLine":9,"gherkinStepLine":23,"keywordType":"Context","textWithKeyword":"Given I start Server","isBg":true,"stepMatchArguments":[]},{"pwStepLine":75,"gherkinStepLine":143,"keywordType":"Action","textWithKeyword":"When I reload session","stepMatchArguments":[]},{"pwStepLine":76,"gherkinStepLine":144,"keywordType":"Action","textWithKeyword":"When I open the app","stepMatchArguments":[]},{"pwStepLine":77,"gherkinStepLine":147,"keywordType":"Action","textWithKeyword":"When I announce: \"This demonstration shows SAML user provisioning. When a new user authenticates via SAML for the first time, Syngrisi automatically creates their account.\"","stepMatchArguments":[{"group":{"start":12,"value":"\"This demonstration shows SAML user provisioning. When a new user authenticates via SAML for the first time, Syngrisi automatically creates their account.\"","children":[{"start":13,"value":"This demonstration shows SAML user provisioning. When a new user authenticates via SAML for the first time, Syngrisi automatically creates their account.","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":78,"gherkinStepLine":148,"keywordType":"Outcome","textWithKeyword":"Then the title is \"Login Page\"","stepMatchArguments":[{"group":{"start":13,"value":"\"Login Page\"","children":[{"start":14,"value":"Login Page","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":79,"gherkinStepLine":151,"keywordType":"Action","textWithKeyword":"When I highlight element \"a[href*='/v1/auth/sso']\"","stepMatchArguments":[{"group":{"start":20,"value":"\"a[href*='/v1/auth/sso']\"","children":[{"start":21,"value":"a[href*='/v1/auth/sso']","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":80,"gherkinStepLine":152,"keywordType":"Action","textWithKeyword":"When I announce: \"This is called Just-in-Time provisioning. User information from the SAML assertion is used to create the Syngrisi account automatically.\"","stepMatchArguments":[{"group":{"start":12,"value":"\"This is called Just-in-Time provisioning. User information from the SAML assertion is used to create the Syngrisi account automatically.\"","children":[{"start":13,"value":"This is called Just-in-Time provisioning. User information from the SAML assertion is used to create the Syngrisi account automatically.","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":81,"gherkinStepLine":155,"keywordType":"Action","textWithKeyword":"When I clear highlight","stepMatchArguments":[]},{"pwStepLine":82,"gherkinStepLine":156,"keywordType":"Action","textWithKeyword":"When I click SSO login button","stepMatchArguments":[]},{"pwStepLine":83,"gherkinStepLine":159,"keywordType":"Action","textWithKeyword":"When I announce: \"The SAML assertion contains user attributes such as email, name, and potentially group memberships. Syngrisi uses these to populate the new user account.\"","stepMatchArguments":[{"group":{"start":12,"value":"\"The SAML assertion contains user attributes such as email, name, and potentially group memberships. Syngrisi uses these to populate the new user account.\"","children":[{"start":13,"value":"The SAML assertion contains user attributes such as email, name, and potentially group memberships. Syngrisi uses these to populate the new user account.","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":84,"gherkinStepLine":162,"keywordType":"Action","textWithKeyword":"When I login to Logto with username \"testuser\" and password \"Test123!\"","stepMatchArguments":[{"group":{"start":31,"value":"\"testuser\"","children":[{"start":32,"value":"testuser","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"},{"group":{"start":55,"value":"\"Test123!\"","children":[{"start":56,"value":"Test123!","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":85,"gherkinStepLine":165,"keywordType":"Outcome","textWithKeyword":"Then I should be redirected back to the app","stepMatchArguments":[]},{"pwStepLine":86,"gherkinStepLine":166,"keywordType":"Outcome","textWithKeyword":"Then I should be authenticated via SSO","stepMatchArguments":[]},{"pwStepLine":87,"gherkinStepLine":169,"keywordType":"Outcome","textWithKeyword":"Then a new user \"test@syngrisi.test\" should be created with role \"reviewer\"","stepMatchArguments":[{"group":{"start":11,"value":"\"test@syngrisi.test\"","children":[{"start":12,"value":"test@syngrisi.test","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"},{"group":{"start":60,"value":"\"reviewer\"","children":[{"start":61,"value":"reviewer","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":88,"gherkinStepLine":172,"keywordType":"Action","textWithKeyword":"When I announce: \"Excellent! A new user account was automatically created with the reviewer role. This streamlines onboarding - no manual account creation required.\"","stepMatchArguments":[{"group":{"start":12,"value":"\"Excellent! A new user account was automatically created with the reviewer role. This streamlines onboarding - no manual account creation required.\"","children":[{"start":13,"value":"Excellent! A new user account was automatically created with the reviewer role. This streamlines onboarding - no manual account creation required.","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":89,"gherkinStepLine":173,"keywordType":"Action","textWithKeyword":"And I end the demo","stepMatchArguments":[]}]},
]; // bdd-data-end